{% with request.resolver_match.url_name as url_name %}
<div class="topnav">
    <a class="{% if url_name == 'books.index' %}active{% endif %}" href="{% url 'books.index' %}">Home</a>
    <a class="{% if url_name == 'books.list_books' %}active{% endif %}" href="{% url 'books.list_books' %}">List Books</a>
    <a class="{% if url_name == 'books.aboutus' %}active{% endif %}" href="{% url 'books.aboutus' %}">About</a>
    
    <div class="topnav-right">
        {% if user.is_authenticated %}
            <span class="welcome-msg">Welcome, {{ user.username }}</span>
            <a href="{% url 'users.logout' %}">Logout</a>
        {% else %}
            <a class="{% if url_name == 'users.login' %}active{% endif %}" href="{% url 'users.login' %}">Login</a>
            <a class="{% if url_name == 'users.register' %}active{% endif %}" href="{% url 'users.register' %}">Register</a>
        {% endif %}
    </div>
</div>

<style>
    /* Existing topnav styles */
    .topnav {
        overflow: hidden;
        background-color: #333;
    }
    
    .topnav a {
        float: left;
        display: block;
        color: #f2f2f2;
        text-align: center;
        padding: 14px 16px;
        text-decoration: none;
        font-size: 17px;
    }
    
    .topnav a:hover {
        background-color: #ddd;
        color: black;
    }
    
    .topnav a.active {
        background-color: #04AA6D;
        color: white;
    }
    
    /* New styles for auth section */
    .topnav-right {
        float: right;
    }
    
    .welcome-msg {
        display: inline-block;
        color: white;
        padding: 14px 16px;
        font-size: 17px;
    }
</style>
{% endwith %}
